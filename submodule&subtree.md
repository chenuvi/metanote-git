---
date: 2025-04
url:
tags:
title: Git submodule 和 subtree 的区别
en-title:
---

# Git submodule 和 subtree 的区别

在本文中，我们将介绍 [Git](https://deepinout.com/git/git-top-tutorials/1696390559_j_git.html "Git 教程") 中的两个重要概念：子模块（submodule）和子树（subtree）。这两种方式都是将一个 [Git](https://deepinout.com/git/git-top-tutorials/1696390559_j_git.html "Git 教程") 仓库嵌套到另一个仓库中的方法，但它们之间有一些关键的区别。在接下来的内容中，我们将详细探讨 submodule 和 subtree 的不同之处，并提供一些示例来帮助理解。

## Git 子模块（Git Submodule）

Git 子模块是通过在主仓库中添加一个子仓库的引用来实现的。换句话说，子模块是一个独立的 Git 仓库，在主仓库中通过引用的方式存在。子模块的更新是独立于主仓库的，它具有自己的提交历史和分支。这使得子模块能够在主仓库的不同版本间保持一致性。

### 添加子模块

要向主仓库添加子模块，可以使用以下命令：

```
git submodule add <仓库URL> <路径>
```


例如，我们想将一个名为 `submodule_repo` 的仓库添加到主仓库的 `submodule` 目录下，可以运行以下命令：

```
git submodule add https://github.com/user/submodule_repo.git submodule
```


这将会在主仓库中添加一个子模块，并将其克隆到 `submodule` 目录下。

### 更新子模块

当子模块的远程仓库发生变化时，我们需要手动更新子模块到最新的版本。可以通过以下两个步骤来完成：

```
git submodule update --remote
```


```
git submodule sync
```



第一步使用了 `--remote` 参数，它会从远程仓库拉取最新的代码。第二步使用了 `sync` 命令，它会更新子模块的 URL。

### 切换子模块分支

子模块中的分支是独立于主仓库的，因此我们可以在子模块中切换分支，而不会对主仓库产生影响。要在子模块中切换分支，可以使用以下命令：

```bash
cd submodule
git checkout <分支名>
```
### 子模块的提交历史和分支

子模块有自己独立的提交历史和分支，这使得它能够在主仓库的不同版本间保持一致性。我们可以使用 `git log` 或 `git branch` 来查看子模块的提交历史和分支情况。

## Git 子树（Git Subtree）

与子模块不同，Git 子树是将一个仓库的完整副本嵌套到另一个仓库中。它不像子模块一样是一个引用，而是一个实体的副本。这意味着子树与主仓库的修改是直接相关的，它们共享相同的提交历史和分支。

### 添加子树

要向主仓库添加一个子树，可以使用以下命令：

```
git subtree add --prefix=<路径> <仓库URL> <分支>
```



例如，我们想将一个名为 `subtree_repo` 的仓库的 `main` 分支添加到主仓库的 `subtree` 目录下，可以运行以下命令：

```
git subtree add --prefix=subtree https://github.com/user/subtree_repo.git main
```

Bash

Copy

### 更新子树

与子模块不同，子树与主仓库的修改是直接相关的。因此，当子树仓库的远程仓库发生变化时，我们可以直接在主仓库中更新子树。可以使用以下命令更新子树：

```
git subtree pull --prefix=<路径> <仓库URL> <分支> --squash
```


例如，我们要更新主仓库中的子树 `subtree` ，可以运行以下命令：
```
git subtree pull --prefix=subtree https://github.com/user/subtree_repo.git main --squash
```

这将会将子树仓库中的最新变更合并到主仓库中。

### 子树的提交历史和分支

因为子树是一个实体的副本，它们与主仓库共享相同的提交历史和分支。我们可以通过 `git log` 或 `git branch` 查看子树的提交历史和分支情况。

## 比较子模块和子树

现在，让我们来总结一下子模块和子树之间的区别：

### 包含性质

-   子模块：子模块是主仓库中的一个引用，它是独立的仓库，具有自己的提交历史和分支。
-   子树：子树是主仓库中的一个实体副本，与主仓库共享相同的提交历史和分支。

### 更新方式

-   子模块：子模块的更新需要手动执行，通过 `git submodule update --remote` 命令来拉取最新的代码。
-   子树：子树与主仓库直接相关，更新子树只需要在主仓库中使用 `git subtree pull` 命令。

### 提交历史和分支

-   子模块：子模块具有自己独立的提交历史和分支，可以在主仓库的不同版本之间保持一致性。
-   子树：子树与主仓库共享相同的提交历史和分支。

根据项目的需求和开发流程，选择适合的方式可以更好地管理子仓库。如果需要保持子仓库的独立性并在主仓库的不同版本间进行切换，可以选择使用子模块。如果主仓库和子仓库之间需要共享相同的提交历史和分支，并且需要更方便地更新子仓库，可以选择使用子树。

## 总结

本文介绍了 Git 中子模块和子树的区别。子模块是主仓库中的一个引用，具有独立的提交历史和分支，更新需要手动处理。而子树是主仓库中的一个实体副本，与主仓库共享相同的提交历史和分支，更新更加方便。根据项目需求选择适合的方式，可以更好地管理嵌套的子仓库。